const scrollLock={lockedClassName:"_locked",defaultItems:document.body.children,specialItems:document.querySelectorAll(".scroll-lock-item"),lock:function(){if(document.body.classList.contains(this.lockedClassName))return;this.scrollbarWidth=window.innerWidth-document.body.offsetWidth;let e=this;function t(t,s){for(let i=0;i<t.length;i++)t[i][s]=parseFloat(getComputedStyle(t[i])[s]),t[i].style[s]=t[i][s]+e.scrollbarWidth+"px"}t(this.defaultItems,"paddingRight"),t(this.specialItems,"marginRight"),document.body.classList.add(this.lockedClassName)},unlock:function(e=0){let t=this;setTimeout((()=>{function e(e,t){for(let s=0;s<e.length;s++)e[s].style[t]=""}e(this.defaultItems,"paddingRight"),e(this.specialItems,"marginRight"),document.body.classList.remove(t.lockedClassName)}),e)}},transitionLock={locked:!1,check:function(e=0){let t=this,s=this.locked;return 0==t.locked&&(t.locked=!0,setTimeout((function(){t.locked=!1}),e)),s}},modal={refs:{translock:transitionLock,scrlock:scrollLock},init:function(e={}){if(this.elemName=e.elem||"modal",this.elem=document.querySelector("."+this.elemName),!this.elem)return;this.timeout=1e3*parseFloat(getComputedStyle(document.body).getPropertyValue("--timer-modal"))||0,this.windows=this.elem.querySelectorAll("."+this.elemName+"__window"),this.links=document.querySelectorAll(e.linkName?"."+e.linkName:".modal-link");for(let e=0;e<this.links.length;e++)this.links[e].addEventListener("click",this.open.bind(this));this.elem.addEventListener("click",function(e){e.target.closest("."+this.elemName+"__wrapper")||this.closeAll()}.bind(this));let t=this.elem.querySelectorAll("."+this.elemName+"__close-button");for(let e=0;e<t.length;e++)t[e].addEventListener("click",this.closeThis.bind(this));this.on=e.on||{}},open:function(e){if(this.refs.translock.check(this.timeout))return;e.preventDefault();let t=this.elem.querySelector(e.currentTarget.getAttribute("href"));t.classList.add("_open"),this.on[t.id]&&this.on[t.id].open&&this.on[t.id].open(e,t.querySelector("."+this.elemName+"__content > *:not(."+this.elemName+"__close-button)"),this.timeout),modal.check()},closeThis:function(e){if(this.refs.translock.check(this.timeout))return;let t=e.target.closest("."+this.elemName+"__window");t.classList.remove("_open"),this.on[t.id]&&this.on[t.id].close&&this.on[t.id].close(e,t.querySelector("."+this.elemName+"__content > *:not(."+this.elemName+"__close-button)"),0),modal.check()},closeAll:function(){if(!this.refs.translock.check(this.timeout)){for(let e=0;e<this.windows.length;e++)this.windows[e].classList.contains("_open")&&(this.windows[e].classList.remove("_open"),this.on[this.windows[e].id]&&this.on[this.windows[e].id].close&&this.on[this.windows[e].id].close(0,0,0));modal.check()}},check:function(){let e=0;for(let t=0;t<this.windows.length;t++)this.windows[t].classList.contains("_open")&&e++;e?(this.elem.classList.add("_visible"),this.refs.scrlock.lock()):(this.elem.classList.remove("_visible"),this.refs.scrlock.unlock(this.timeout))}};modal.init({on:{"modal-form":{close:function(e,t,s){setTimeout((()=>{formToEmail.clean(document.querySelector(".contact-form"))}),s)}}}});const upButton={init:function(){this.elem=document.querySelector(".up-button"),this.elem&&(this.prevPos=pageYOffset,this.visible=!1,window.addEventListener("scroll",this.showButton.bind(this)),this.elem.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})})))},showButton:function(){function e(e,t){t?e.elem.classList.add("_visible"):e.elem.classList.remove("_visible"),e.visible=t}pageYOffset<window.innerHeight?1==this.visible&&e(this,!1):pageYOffset>=document.body.scrollHeight-window.innerHeight?0==this.visible&&e(this,!0):(pageYOffset<this.prevPos&&0==this.visible&&e(this,!0),pageYOffset>this.prevPos&&1==this.visible&&e(this,!1),this.prevPos=pageYOffset)}};upButton.init();const formToEmail={messages:{ok:"Сообщение отправлено",okDemo:"Your message has been sent (demo)",error:"Ошибка при отправке сообщения",emptyReqField:"Пожалуйста, заполните все поля",incorrectName:"Некорректное имя",incorrectEmail:"Некорректный email"},init:function(e=!1){this.demo=e,this.inputs=document.querySelectorAll("form input, form textarea");for(let e=0;e<this.inputs.length;e++)this.inputs[e].addEventListener("input",(function(){this.classList.remove("_error")})),"phone"==this.inputs[e].getAttribute("name")&&(this.inputs[e].addEventListener("input",this.editPhoneByMask,!1),this.inputs[e].addEventListener("focus",this.editPhoneByMask,!1),this.inputs[e].addEventListener("blur",this.editPhoneByMask,!1),this.inputs[e].addEventListener("keydown",this.editPhoneByMask,!1));for(let e=0;e<document.forms.length;e++)document.forms[e].addEventListener("submit",this.send.bind(this))},send:async function(e){e.preventDefault();let t=e.target.querySelector(".form-report");t.classList.remove("ok"),t.classList.remove("er");let s=this.check(e.target);if(s[0])return t.classList.add("er"),void(1==s[0]?t.innerHTML=s[1][0]:t.innerHTML=this.messages.emptyReqField);t.innerHTML="";let i,o=new FormData(e.target);o.append("form",e.target.getAttribute("name")),this.addCustomInputs(e,o,"input-range"),this.log(o),e.target.classList.add("_sending"),this.demo?(i=await new Promise((function(e,t){setTimeout((()=>e()),2e3)})),i={ok:!0}):i=await fetch("php/sendmail.php",{method:"POST",body:o}),i.ok?(t.classList.add("ok"),this.demo?t.innerHTML=this.messages.okDemo:t.innerHTML=this.messages.ok,this.clean(e.target,!1)):(t.classList.add("er"),t.innerHTML=this.messages.error),e.target.classList.remove("_sending")},check:function(e){let t=[],s=e.querySelectorAll("input, textarea");for(let e=0;e<s.length;e++)if(s[e].classList.remove("_error"),s[e].classList.contains("_req")&&""==s[e].value)s[e].classList.add("_error"),t.push(this.messages.emptyReqField);else switch(s[e].getAttribute("name")){case"name":s[e].value&&0==/^.{2,}$/.test(s[e].value)&&(s[e].classList.add("_error"),t.push(this.messages.incorrectName));break;case"email":s[e].value&&0==/^[0-9a-zA-Z-.]{3,}@[a-z]{3,}\.[a-z]{2,5}$/.test(s[e].value)&&(s[e].classList.add("_error"),t.push(this.messages.incorrectEmail));break;case"phone":s[e].value&&0==/^\+\d\s\(\d{3}\)\s\d{3}(-\d\d){2}$/.test(s[e].value)&&(s[e].classList.add("_error"),t.push(this.messages.incorrectPhone))}return[t.length,t]},log:function(e){for(let t of e.entries())console.log(t[0]+": "+t[1])},addCustomInputs:function(e,t,s){let i=e.target.querySelectorAll("."+s);for(let e=0;e<i.length;e++)t.append(i[e].getAttribute("name"),i[e].getAttribute("value"))},clean:function(e,t=!0){if(!e)return;let s=e.querySelectorAll("input, textarea");for(let e=0;e<s.length;e++)s[e].hasAttribute("name")&&(s[e].value=""),t&&s[e].classList.remove("_error");if(t){let t=e.querySelector(".form-report");t.classList.remove("ok"),t.classList.remove("er"),t.innerHTML=""}},editPhoneByMask:function(e){e.keyCode&&(keyCode=e.keyCode),this.selectionStart<3&&e.preventDefault();var t="+7 (___) ___-__-__",s=0,i=t.replace(/\D/g,""),o=this.value.replace(/\D/g,""),n=t.replace(/[_\d]/g,(function(e){return s<o.length?o.charAt(s++)||i.charAt(s):e}));-1!=(s=n.indexOf("_"))&&(s<5&&(s=3),n=n.slice(0,s));var l=t.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");(!(l=new RegExp("^"+l+"$")).test(this.value)||this.value.length<5||keyCode>47&&keyCode<58)&&(this.value=n),"blur"==e.type&&this.value.length<5&&(this.value="")}};formToEmail.init();let portfolioElement=document.querySelector(".portfolio"),portfolioButton=document.querySelector(".profile__portfolio-button");portfolioButton.addEventListener("click",(function(){portfolioElement.scrollIntoView({behavior:"smooth"})})),document.querySelector(".portfolio__counter").innerHTML=" ("+document.querySelectorAll(".site").length+")";